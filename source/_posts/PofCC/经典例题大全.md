---
title: 第三章 存储系统
math: true
date: 2023-08-30 16:07:00
---

# 经典例题大全

## 第三章 存储系统

### Cache和主存的映射关系

假设某个计算机的主存地址空间为256MB，按字节编址，其数据Cache有8个Cache行，行长为64B。

1）若不考虑用于Cache的一致维护性和替换性算法，并且采用直接映射方式，则该数据Cache的总容量为多少？
$$
256MB=2^8\times 2^{20}\times 2^3 b=2^{31}b \\
64B=2^6\times 2^3=2^9b \\
采用直接映射的主存地址结构：标记位-块号-块内地址\\
故块内地址占用9位，块号占3位，则标记位占31-12=19位\\
而采用直接映射的Cache行由标记阵列和存储容量组成，\\
又由于题设说明不考虑一致维护性和替换性算法，\\
故此时的Cache就不考虑一致性维护位和替换算法控制位，\\
因此该Cache标记项包含：有效位和标记位,此时Cache标记项占1+19=20位\\
所以Cache总容量=8\times 20 + 8\times 64\times 8=160+2^{12}=160+4096=4256
$$
2）若该Cache采用直接映射方式，则主存地址为3200（十进制）的主存块对应的Cache行号是多少？采用二路组相连映射时又是多少？
$$
3200/64=50,50\mod 8 =2, row_{n}=2
$$
3）以直接映射方式为例，简述访存过程（设访存的地址为012345H）。

```
描述主存地址结构：28位主存地址分为19位标志位，3位块号，6位块内地址，即0000 0001 0010 010为标记位，001为块号，010110为块内地址
描述CPU访存过程
	第一步：根据块号，查Cache中对应的标记号，对比是否相同
	第二步：如果相同，再看Cache行中的转入有效位是否为1
	第三步：如果为1，则表示有效，称此访问命中，按块内地址读出Cache行所对应的单元并送入CPU中，完成访存。
	第四步：若有效位为0或标记位不相等，则不命中，访问主存将数据取出并送往CPU和Cache的对应块中，把主存的最高19位存入001行的tag中，并将有效位置1。

```

> 每个Cache行对应一个标记项——有效位、标记位、一致性维护位、替换算法控制位，在组相联映射中，将每组的标记项排成一行，将各组从上到下排列，成为一个二维的标记阵列（直接映射一行就是一组）。查找Cache时就是查找标记阵列的标记项是否符合要求。